<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Observability - Facets Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Observability";
    var mkdocs_page_input_path = "tools/observability.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Facets Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../getting_started/prerequisites/">Prerequisites</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting_started/demo/">Demo</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Operate your Cluster</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Observability</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#observability">Observability</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#metrics">Metrics</a></li>
        
            <li><a class="toctree-l4" href="#logs">Logs</a></li>
        
            <li><a class="toctree-l4" href="#traces">Traces</a></li>
        
            <li><a class="toctree-l4" href="#alerts">Alerts</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../compliance/">Compliance & Security</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Roadmap</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../roadmap/roadmap/">Roadmap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../roadmap/request/">Request a feature</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Facets Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Operate your Cluster &raquo;</li>
        
      
    
    <li>Observability</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="observability">Observability</h1>
<p>The following are usually the three levers to build in-depth observability to your application deployments in production environment
* Metrics
* Logs
* Tracing</p>
<h2 id="metrics">Metrics</h2>
<p>The deployments created through Facets ships with a built-in <a href="https://grafana.com/">Grafana</a> and <a href="https://prometheus.io/">Prometheus</a> set up with pre-integrations to standard components and relevant dashboards.
The Grafana dashboard can be accessed through the control plane or with cluster specific URLs by the develops, devops and support staff.</p>
<p><img alt="Grafana Dashboard" src="../../media/grafana.png" /></p>
<p>The metrics collected by Prometheus are usually of the following types
* Infrastructure Metrics (Pre-built metric exporters)
* Application Metrics (<a href="https://opentelemetry.io/">Open telemetry</a>)</p>
<h3 id="infrastructure-metrics">Infrastructure Metrics</h3>
<p>Any components instantiated through Facets comes with the relevant pre-built metrics dashboards. The following
graphs shows a pre-built redis dashboard. 
<img alt="Redis Dashboard" src="../../media/redis.png" /></p>
<h3 id="application-metrics">Application Metrics</h3>
<p>Facets.cloud adopts <a href="https://opentelemetry.io/">Open Telemetry</a> standards for pushing metrics. Applications expose metrics as end-points and declare it as a
monitoring object inside the FSDL application specifications. Facets.cloud instruments the scraping of these metrics out of the application metrics end-points and submits to Prometheus.</p>
<h3 id="user-defined-dashboards">User Defined Dashboards</h3>
<p>Dashboards can also be defined in Facet stack definition language by committing the exported json from grafana into the stack definition</p>
<blockquote>
<p>place the json file in <strong>/dashboards/instances</strong> directory in your stack</p>
</blockquote>
<h3 id="metrics-integrations-with-third-party-tools">Metrics Integrations with third party tools</h3>
<p>You can use your favourite third-party tools like Newrelic to visualize the metrics apart
from the Grafana dashboard. The Newrelic pre-integration relays metrics from prometheus to Newrelic without any other code change
to the application.</p>
<blockquote>
<p>Add <code>NEWRELIC_LICENSE_KEY</code> to the Common Environment Variables to enable the pre-integration. The following shows the earlier
redis dashboard on newrelic.</p>
</blockquote>
<p><img alt="Newrelic redis Dashboard" src="../../media/redisnewrelic.png" /></p>
<h2 id="logs">Logs</h2>
<blockquote>
<p>Facets expects all application containers to log to <code>system.out</code>. For most languages, this can be achieved by using a console appender to the code. </p>
</blockquote>
<p>Facets uses fluentd to relay logs and presents various options of log collection. </p>
<h3 id="nfs-with-object-storage-as-backup">NFS with object storage as backup</h3>
<p>This option usually translates to an EFS with S3 if the deployment is on AWS cloud. This option by default acts as
the source of truth of all the log storage at a single place. The logs are organized as folders in <code>application/containers</code> and get pushed to S3 
at configured time interval.The logs can be accessed through a <a href="https://www.npmjs.com/package/wetty">Wetty</a> terminal after a required authorization by the user. Older logs can be downloaded from s3 on need-basis on the same console.
<img alt="Wetty login" src="../../media/wetty.png" /></p>
<h3 id="additional-logging-substacks">Additional logging substacks</h3>
<ul>
<li><a href="https://www.elastic.co/what-is/elk-stack">ELK</a> - Additional to EFS/NFS as logging, an ELK substack can be chosen to index and search the logs. 
Depending on the log volumes produced by the applications per-day, this may be an effective solution</li>
<li>More log collection options are in development ..   </li>
</ul>
<h2 id="traces">Traces</h2>
<blockquote>
<p>Facets doesn't provide any tracing integrations yet. Tracing is usually instrumented inside the application code.</p>
</blockquote>
<h2 id="alerts">Alerts</h2>
<p>All active and inactive alerts can be obtained through <code>Alerts</code> dropdown in the control plane. </p>
<p><img alt="Alert login" src="../../media/alerts.png" /></p>
<p>The set of alerts can be categorized in to two parts
1. Standard Alerts - Facets ships standard alerts with each component that is defined in the stack. 
2. User defined Alerts - Additionally, alerts can be defined in <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/">PromQL</a> and committed in
the stack git repo, which will be automatically available in all deployments</p>
<p>These Alerts can be defined in Facet stack definition language by committing the <strong>alertmanager yaml</strong> into the stack definition</p>
<blockquote>
<p>place the yaml file in <strong>/alerts/instances</strong> directory in your stack</p>
</blockquote>
<p>Sample Yaml File:
   <code>- name: mongo.rules
      rules:
    - alert: MongoRelicaStatusSecondaryCrit
      expr: mongodb_mongod_replset_member_state{state="SECONDARY"} != 2
      for: 2m
      labels:
      severity: critical
      team: infra
      resourceType: mongo
      resourceName: "{{ $labels.pod_name }}"
      annotations:
      message: MongoDB secondary replica status down</code>
   The alerts can be pushed to ChatOPs tools like Slack or flock. Any team that has added the corresponding module as an observer,<br />
receives the alert for that module by the channel updates.</p>
<p><img alt="Flock Alert" src="../../media/flock.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../compliance/" class="btn btn-neutral float-right" title="Compliance & Security">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../getting_started/demo/" class="btn btn-neutral" title="Demo"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../getting_started/demo/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../compliance/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
